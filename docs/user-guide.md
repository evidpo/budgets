# Руководство пользователя приложения "Семейные финансы"

## Обзор приложения

Приложение "Семейные финансы" предназначено для управления личными и семейными финансами. Оно позволяет отслеживать доходы и расходы, управлять бюджетами, контролировать долги и кредиты, а также формировать финансовые отчеты.

## Начало работы

### Регистрация и вход в систему

1. Откройте приложение в браузере
2. Нажмите "Войти" или "Зарегистрироваться"
3. Введите свои учетные данные (email и пароль)
4. После регистрации вы автоматически создадите домохозяйство по умолчанию

### Создание домохозяйства

После регистрации вы автоматически становитесь владельцем домохозяйства. Домохозяйство - это группа пользователей, которые совместно управляют финансами (например, семья или компания).

## Основные разделы приложения

### 1. Счета

Раздел "Счета" позволяет управлять финансовыми счетами: банковские счета, наличные, кредиты и т.д.

#### Создание счета
1. Перейдите на страницу "Счета"
2. Нажмите кнопку "Добавить счет"
3. Заполните следующие поля:
   - Название счета
   - Тип счета (наличные, карта, сберегательный, кредит и др.)
   - Валюта (по умолчанию EUR)
   - Начальный баланс
   - Примечание (необязательно)
4. Нажмите "Сохранить"

#### Редактирование счета
1. Найдите нужный счет в списке
2. Нажмите на значок редактирования рядом с ним
3. Внесите изменения в данные счета
4. Нажмите "Сохранить"

#### Архивация счета
1. Найдите нужный счет в списке
2. Нажмите на значок редактирования
3. Установите флаг "Архивный"
4. Нажмите "Сохранить"

Архивированные счета не отображаются в основных списках, но все транзакции по ним сохраняются.

#### Изменение порядка счетов
Вы можете изменить порядок отображения счетов, перетаскивая их в списке. Порядок сохраняется автоматически.

### 2. Транзакции

Раздел "Транзакции" позволяет управлять доходами, расходами и переводами между счетами.

#### Создание транзакции
1. Перейдите на страницу "Транзакции"
2. Нажмите кнопку "Добавить транзакцию"
3. Выберите тип транзакции: доход, расход или перевод
4. Заполните соответствующие поля:
   - Дата
   - Счет (для дохода/расхода)
   - Сумма (положительная для дохода, отрицательная для расхода)
   - Категория (необязательно)
   - Плательщик/получатель
   - Примечание
5. Нажмите "Сохранить"

#### Создание перевода
1. При создании транзакции выберите тип "Перевод"
2. Укажите счет списания и счет зачисления
3. Введите сумму перевода
4. Остальные поля заполняются автоматически
5. Нажмите "Сохранить"

#### Фильтрация транзакций
На странице транзакций доступны фильтры:
- По дате (диапазон)
- По счету
- По категории
- По типу (доход/расход/перевод)
- По плательщику

### 3. Бюджеты

Раздел "Бюджеты" позволяет планировать и контролировать расходы и доходы по различным категориям и периодам.

#### Создание бюджета
1. Перейдите на страницу "Бюджеты"
2. Нажмите кнопку "Добавить бюджет"
3. Заполните следующие поля:
   - Название бюджета
   - Тип периода (неделя, месяц, квартал, год, кастомный)
   - Дата начала и окончания (для кастомного периода)
   - Сумма бюджета
   - Направление (доход или расход)
   - Флаг переноса остатка (rollover)
   - Включение поддерева категорий
4. Настройте фильтрацию: выберите счета и/или категории, которые будут включены в бюджет
5. Нажмите "Сохранить"

#### Редактирование бюджета
1. Найдите нужный бюджет в списке
2. Нажмите на значок редактирования
3. Внесите изменения в настройки бюджета
4. Нажмите "Сохранить"

#### Понимание переноса остатка
При включенном переносе остатка (rollover):
- Если в текущем периоде вы потратили меньше бюджета, разница переносится в следующий период
- Если в текущем периоде вы потратили больше бюджета, перенос может быть отрицательным
- Перенос влияет на доступный бюджет в следующем периоде

### 4. Категории

Раздел "Категории" позволяет создавать иерархическую структуру для классификации транзакций.

#### Создание категории
1. Перейдите на страницу "Категории"
2. Нажмите кнопку "Добавить категорию"
3. Заполните следующие поля:
   - Название категории
   - Родительская категория (для создания иерархии)
   - Тип (доход или расход)
   - Иконка (необязательно)
   - Цвет (необязательно)
4. Нажмите "Сохранить"

#### Иерархия категорий
Категории поддерживают древовидную структуру:
- Категории верхнего уровня (например, "Расходы", "Доходы")
- Подкатегории (например, "Продукты" в "Расходы")
- Подкатегории подкатегорий и т.д.

#### Использование категорий
Категории используются для:
- Классификации транзакций
- Формирования отчетов
- Настройки бюджетов

### 5. Долги

Раздел "Долги" позволяет управлять займами, кредитами и долговыми обязательствами.

#### Создание долга
1. Перейдите на страницу "Долги"
2. Нажмите кнопку "Добавить долг"
3. Заполните следующие поля:
   - Название долга
   - Контрагент (кто дал/взял займ)
   - Начальный баланс (сумма долга)
   - Процентная ставка (необязательно)
   - Минимальный платеж (необязательно)
   - Дата начала и окончания (необязательно)
   - Примечание
4. Нажмите "Сохранить"

#### Управление долгом
Для учета погашения или получения займа создавайте транзакции:
- Для получения займа создайте транзакцию с положительной суммой (доход)
- Для погашения займа создайте транзакцию с отрицательной суммой (расход)
- Свяжите транзакцию с долгом при создании

### 6. Правила автокатегоризации

Раздел "Правила" позволяет создавать правила для автоматического присвоения категорий транзакциям.

#### Создание правила
1. Перейдите на страницу "Правила"
2. Нажмите кнопку "Добавить правило"
3. Выберите тип правила:
   - По плательщику: автоматическое назначение категории при совпадении плательщика
   - По регулярному выражению: автоматическое назначение категории при совпадении с паттерном
   - По паттерну суммы: автоматическое назначение категории при совпадении суммы с шаблоном
4. Установите приоритет (выше число - выше приоритет)
5. Выберите категорию, которая будет применяться
6. Введите паттерн для поиска
7. Нажмите "Сохранить"

#### Приоритеты правил
При применении правил учитываются приоритеты:
- Правила по плательщику имеют наивысший приоритет
- Затем идут правила по регулярным выражениям
- Затем правила по паттернам суммы

### 7. Отчеты

Раздел "Отчеты" позволяет анализировать финансовые данные.

#### Доступные отчеты
- **Общий баланс**: текущий баланс всех счетов
- **По бюджетам**: сравнение факта и лимита по бюджетам
- **По счетам**: движение средств по счетам за период
- **Доходы по категориям**: анализ доходов по категориям
- **Расходы по категориям**: анализ расходов по категориям

#### Фильтрация отчетов
Все отчеты поддерживают фильтрацию:
- По дате (диапазон)
- Исключение переводов из расчетов
- Группировка по родительским категориям

#### Экспорт отчетов
Отчеты можно экспортировать в формат CSV для дальнейшей обработки.

### 8. Импорт данных

Раздел "Импорт" позволяет загружать финансовые данные из внешних источников (CSV файлы, спецификация Alzex).

#### Процесс импорта
1. Перейдите на страницу "Импорт"
2. Нажмите кнопку "Выбрать файл" и выберите CSV файл
3. Приложение автоматически определит формат файла
4. Сопоставьте поля CSV файла с полями транзакций
5. Просмотрите предварительный список транзакций
6. Нажмите "Импортировать"

#### Мастер склейки переводов
После импорта:
1. Система автоматически предложит возможные пары переводов
2. Проверьте предложенные пары и подтвердите или отклоните их
3. Подтвержденные пары получат общий ID перевода
4. Переводы будут корректно отображаться в системе

#### Откат импорта
Если импорт был выполнен с ошибками:
1. Перейдите на страницу "Импорт"
2. Найдите импортированные транзакции
3. Используйте функцию отката для возврата к предыдущему состоянию

## Совместная работа

### Роли пользователей
В домохозяйстве поддерживаются следующие роли:
- **Владелец**: полный доступ ко всем данным и настройкам
- **Редактор**: может просматривать, создавать и изменять данные
- **Наблюдатель**: только просмотр данных

### Приглашения
1. Перейдите в настройки домохозяйства
2. Нажмите "Пригласить участника"
3. Введите email приглашаемого пользователя
4. Выберите роль
5. Отправьте приглашение

Приглашенный пользователь получит email с инструкциями по присоединению к домохозяйству.

## Безопасность и конфиденциальность

- Все данные шифруются на уровне базы данных
- Пароли хранятся в зашифрованном виде
- Доступ к данным ограничен домохозяйством пользователя
- Используется JWT-аутентификация для защиты сессий